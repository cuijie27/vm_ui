<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		<script src="../js/mui.min.js"></script>
		<link href="../css/mui.min.css" rel="stylesheet" />
		<script type="text/javascript" charset="utf-8">
			mui.init();
		</script>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">关于索问</h1>
		</header>
		<div class="mui-content">

			<ul class="mui-table-view">
				<li class="mui-table-view-cell">
					<a id="rate" class="mui-navigate-right">评分鼓励</a>
				</li>
				<li class="mui-table-view-cell">
					<a id="share" class="mui-navigate-right">分享推荐</a>
				</li>
				<li class="mui-table-view-cell">
					<a id="tel" class="mui-navigate-right">客服电话</a>
				</li>
			</ul>

		</div>
	</body>
<script>
	//分享操作
		var shares = {};
		mui.plusReady(function () {
			plus.share.getServices(function (s) {
				if(s&&s.length>0){
					for (var i = 0; i < s.length; i++) {
						var t = s[i];
						shares[t.id] = t;
					}
				}
			},function () {
				console.log("获取分享服务列表失败");
			});
		});
		
		//分享链接点击事件
		document.getElementById("share").addEventListener('tap',function () {
			var ids=[{id:"weixin",ex:"WXSceneSession"},{id:"weixin",ex:"WXSceneTimeline"},{id:"sinaweibo"},{id:"tencentweibo"}],
			bts=[{title:"发送给微信好友"},{title:"分享到微信朋友圈"},{title:"分享到新浪微博"},{title:"分享到腾讯微博"}];
			if(plus.os.name=="iOS"){
				ids.push({id:"qq"});
				bts.push({title:"分享到QQ"});
			}
			plus.nativeUI.actionSheet({cancel:"取消",buttons:bts},function(e){
				var i=e.index;
				if(i>0){
					var s_id = ids[i-1].id;
					var share = shares[s_id];
					if ( share.authenticated ) {
						shareMessage(share,ids[i-1].ex);
					} else {
						share.authorize( function(){
								shareMessage(share,ids[i-1].ex);
							},function(e){
							console.log( "认证授权失败："+e.code+" - "+e.message );
						});
					}
				}
			});
		});
		
		function shareMessage(share,ex){
			var msg={extra:{scene:ex}};
			msg.href="http://www.dcloud.io/hellomui/";
			msg.title="最接近原生APP体验的高性能前端框架";
			msg.content="我正在体验HelloMUI，果然很流畅，基本看不出和原生App的差距";
			if(~share.id.indexOf('weibo')){
				msg.content += "；体验地址：http://www.dcloud.io/hellomui/";
			}
			msg.thumbs=["_www/images/logo.png"];
			share.send( msg, function(){
				console.log( "分享到\""+share.description+"\"成功！ " );
			}, function(e){
				console.log( "分享到\""+share.description+"\"失败: "+e.code+" - "+e.message );
			} );
		}
		
		//去评分
		document.getElementById("rate").addEventListener('tap',function () {
			if(mui.os.ios){
				location.href = 'https://itunes.apple.com/WebObjects/MZStore.woa/wa/viewContentsUserReviews?id=682211190&pageNumber=0&sortOrdering=2&type=&mt=8';
			}else if(mui.os.android){
			        plus.runtime.openURL( "market://details?id=io.dcloud.HelloMUI", function(e){ 
			        	plus.runtime.openURL( "market://details?id=io.dcloud.HelloMUI", function(e){ 
					    	mui.alert("360手机助手和应用宝，你一个都没装，暂时无法评分，感谢支持"); 
			        	}, "com.qihoo.appstore" );
				    }, "com.tencent.android.qqdownloader" ); 
			}
		});
		
		//客服电话
		document.getElementById("tel").addEventListener('tap',function () {
			plus.device.dial("114");
		});
		
</script>
</html>